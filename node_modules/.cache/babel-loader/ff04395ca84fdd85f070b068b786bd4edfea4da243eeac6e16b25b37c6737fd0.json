{"ast":null,"code":"var _s = $RefreshSig$();\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Form, Select, Col, Spin, message } from \"antd\";\nimport { IconDropDown } from \"@assets/icons\";\nimport { collectionApi } from \"@services/apis/collection\";\nfunction MySelectScrollLoading(_ref) {\n  _s();\n  let {\n    listOptions,\n    placeholder,\n    style,\n    optionFilterProp,\n    disabled,\n    name,\n    rules,\n    className,\n    label,\n    mode,\n    colwidth,\n    fetchData,\n    hideField = true,\n    listDeletedId,\n    listInitialId,\n    setListDeletedId,\n    returnOption,\n    limit,\n    onChange,\n    onSearch,\n    ...props\n  } = _ref;\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(true);\n  const handleLoadMore = async () => {\n    if (!hasMore) return; // Không còn dữ liệu để tải\n    setLoading(true);\n    try {\n      const data = await fetchData({\n        page,\n        take: 10,\n        limit: limit || 10\n      });\n      const newOptions = data === null || data === void 0 ? void 0 : data.map(returnOption);\n      setLoading(false);\n      setPage(page + 1);\n      setOptions([...options, ...newOptions]);\n      setHasMore(newOptions.length > 0);\n    } catch (error) {\n      message.error(error);\n    }\n  };\n  const handlePopupScroll = e => {\n    const {\n      scrollTop,\n      clientHeight,\n      scrollHeight\n    } = e.target;\n    if (scrollHeight - scrollTop === clientHeight) {\n      handleLoadMore();\n    }\n  };\n  const handleDeleted = value => {\n    if (!(listDeletedId !== null && listDeletedId !== void 0 && listDeletedId.includes(value)) && listInitialId !== null && listInitialId !== void 0 && listInitialId.includes(value)) {\n      setListDeletedId(prev => [...prev, value]);\n    }\n  };\n  const handleClear = () => {\n    setListDeletedId(listInitialId);\n  };\n  const filterOption = (input, option) => {\n    var _option$label;\n    return ((_option$label = option === null || option === void 0 ? void 0 : option.label) !== null && _option$label !== void 0 ? _option$label : \"\").toLowerCase().includes(input.toLowerCase());\n  };\n  useEffect(async () => {\n    try {\n      const data = await fetchData({\n        page,\n        take: 20,\n        limit: limit || 10\n      });\n      const newOptions = data === null || data === void 0 ? void 0 : data.map(returnOption);\n      setOptions(newOptions);\n      setPage(page + 1);\n    } catch (error) {\n      message.error(error);\n    }\n  }, []);\n  const isMobile = window.location.pathname.split(\"/\").includes(\"mobile\");\n  return hideField && /*#__PURE__*/React.createElement(Col, {\n    xs: colwidth || 24\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    rules: rules,\n    label: label,\n    name: name,\n    className: \"select-scroll-loading\"\n  }, /*#__PURE__*/React.createElement(Select, _extends({\n    mode: mode,\n    allowClear: true,\n    disabled: disabled,\n    loading: loading,\n    style: {\n      width: \"100%\"\n    },\n    onPopupScroll: handlePopupScroll,\n    placeholder: placeholder,\n    filterOption: filterOption,\n    optionFilterProp: optionFilterProp,\n    className: `${className} ${isMobile ? \"fz-12\" : \"\"}`,\n    notFoundContent: loading ? /*#__PURE__*/React.createElement(Spin, {\n      size: \"small\"\n    }) : \"No data\",\n    onDeselect: handleDeleted,\n    onClear: handleClear,\n    onChange: onChange,\n    onSearch: onSearch,\n    showSearch: true,\n    options: options\n  }, props), options === null || options === void 0 ? void 0 : options.map(item => /*#__PURE__*/React.createElement(Select.Option, {\n    key: item === null || item === void 0 ? void 0 : item.key,\n    value: item === null || item === void 0 ? void 0 : item.value,\n    className: isMobile ? \"fz-12\" : \"\"\n  }, item === null || item === void 0 ? void 0 : item.label)))));\n}\n_s(MySelectScrollLoading, \"suCis+1CabY4DfL+VwImICr86HY=\");\n_c = MySelectScrollLoading;\nexport default MySelectScrollLoading;\nMySelectScrollLoading.propTypes = {\n  listOptions: PropTypes.array,\n  placeholder: PropTypes.string,\n  style: PropTypes.object,\n  optionFilterProp: PropTypes.string,\n  disabled: PropTypes.bool,\n  name: PropTypes.any,\n  rules: PropTypes.array,\n  className: PropTypes.string,\n  label: PropTypes.string,\n  mode: PropTypes.string,\n  colwidth: PropTypes.number,\n  fetchData: PropTypes.func,\n  hideField: PropTypes.bool,\n  setListDeletedId: PropTypes.func,\n  listDeletedId: PropTypes.array,\n  listInitialId: PropTypes.array,\n  returnOption: PropTypes.func,\n  limit: PropTypes.number,\n  onChange: PropTypes.func,\n  onSearch: PropTypes.func\n};\nvar _c;\n$RefreshReg$(_c, \"MySelectScrollLoading\");","map":{"version":3,"mappings":"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","names":["React","useState","useEffect","PropTypes","Form","Select","Col","Spin","message","IconDropDown","collectionApi","MySelectScrollLoading","listOptions","placeholder","style","optionFilterProp","disabled","name","rules","className","label","mode","colwidth","fetchData","hideField","listDeletedId","listInitialId","setListDeletedId","returnOption","limit","onChange","onSearch","props","options","setOptions","loading","setLoading","page","setPage","hasMore","setHasMore","handleLoadMore","data","take","newOptions","map","length","error","handlePopupScroll","e","scrollTop","clientHeight","scrollHeight","target","handleDeleted","value","includes","prev","handleClear","filterOption","input","option","toLowerCase","isMobile","window","location","pathname","split","xs","Item","allowClear","width","onPopupScroll","notFoundContent","size","onDeselect","onClear","showSearch","item","Option","key","propTypes","array","string","object","bool","any","number","func"],"sources":["/home/huynd/animalwatch_admin/src/components/form/MySelectScrollLoading.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Form, Select, Col, Spin, message } from \"antd\";\nimport { IconDropDown } from \"@assets/icons\";\n\nimport { collectionApi } from \"@services/apis/collection\";\n\nfunction MySelectScrollLoading({\n  listOptions,\n  placeholder,\n  style,\n  optionFilterProp,\n  disabled,\n  name,\n  rules,\n  className,\n  label,\n  mode,\n  colwidth,\n  fetchData,\n  hideField = true,\n  listDeletedId,\n  listInitialId,\n  setListDeletedId,\n  returnOption,\n  limit,\n  onChange,\n  onSearch,\n  ...props\n}) {\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(true);\n\n  const handleLoadMore = async () => {\n    if (!hasMore) return; // Không còn dữ liệu để tải\n    setLoading(true);\n    try {\n      const data = await fetchData({ page, take: 10, limit: limit || 10 });\n      const newOptions = data?.map(returnOption);\n      setLoading(false);\n      setPage(page + 1);\n      setOptions([...options, ...newOptions]);\n      setHasMore(newOptions.length > 0);\n    } catch (error) {\n      message.error(error);\n    }\n  };\n  const handlePopupScroll = (e) => {\n    const { scrollTop, clientHeight, scrollHeight } = e.target;\n    if (scrollHeight - scrollTop === clientHeight) {\n      handleLoadMore();\n    }\n  };\n\n  const handleDeleted = (value) => {\n    if (!listDeletedId?.includes(value) && listInitialId?.includes(value)) {\n      setListDeletedId((prev) => [...prev, value]);\n    }\n  };\n\n  const handleClear = () => {\n    setListDeletedId(listInitialId);\n  };\n\n  const filterOption = (input, option) =>\n    (option?.label ?? \"\").toLowerCase().includes(input.toLowerCase());\n\n  useEffect(async () => {\n    try {\n      const data = await fetchData({ page, take: 20, limit: limit || 10 });\n      const newOptions = data?.map(returnOption);\n      setOptions(newOptions);\n      setPage(page + 1);\n    } catch (error) {\n      message.error(error);\n    }\n  }, []);\n\n  const isMobile = window.location.pathname.split(\"/\").includes(\"mobile\");\n  return (\n    hideField && (\n      <Col xs={colwidth || 24}>\n        <Form.Item\n          rules={rules}\n          label={label}\n          name={name}\n          className=\"select-scroll-loading\"\n        >\n          <Select\n            mode={mode}\n            allowClear\n            disabled={disabled}\n            loading={loading}\n            style={{ width: \"100%\" }}\n            onPopupScroll={handlePopupScroll}\n            placeholder={placeholder}\n            filterOption={filterOption}\n            optionFilterProp={optionFilterProp}\n            className={`${className} ${isMobile ? \"fz-12\" : \"\"}`}\n            notFoundContent={loading ? <Spin size=\"small\" /> : \"No data\"}\n            onDeselect={handleDeleted}\n            onClear={handleClear}\n            onChange={onChange}\n            onSearch={onSearch}\n            showSearch\n            options={options}\n            {...props}\n          >\n            {options?.map((item) => (\n              <Select.Option\n                key={item?.key}\n                value={item?.value}\n                className={isMobile ? \"fz-12\" : \"\"}\n              >\n                {item?.label}\n              </Select.Option>\n            ))}\n          </Select>\n        </Form.Item>\n      </Col>\n    )\n  );\n}\n\nexport default MySelectScrollLoading;\n\nMySelectScrollLoading.propTypes = {\n  listOptions: PropTypes.array,\n  placeholder: PropTypes.string,\n  style: PropTypes.object,\n  optionFilterProp: PropTypes.string,\n  disabled: PropTypes.bool,\n  name: PropTypes.any,\n  rules: PropTypes.array,\n  className: PropTypes.string,\n  label: PropTypes.string,\n  mode: PropTypes.string,\n  colwidth: PropTypes.number,\n  fetchData: PropTypes.func,\n  hideField: PropTypes.bool,\n  setListDeletedId: PropTypes.func,\n  listDeletedId: PropTypes.array,\n  listInitialId: PropTypes.array,\n  returnOption: PropTypes.func,\n  limit: PropTypes.number,\n  onChange: PropTypes.func,\n  onSearch: PropTypes.func,\n};\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}